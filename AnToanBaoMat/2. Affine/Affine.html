<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>M√£ h√≥a Affine Cipher</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
            max-width: 600px;
            margin: auto;
            padding: 40px;
        }
        input, textarea, button {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            font-size: 16px;
        }
        button {
            background-color: #0077cc;
            color: white;
            border: none;
            cursor: pointer;
        }
        button:hover {
            background-color: #005fa3;
        }
    </style>
</head>
<body>
    <h2>üîê M√£ h√≥a Affine Cipher</h2>

    <label for="inputText">VƒÉn b·∫£n:</label>
    <textarea id="inputText" rows="4" placeholder="Nh·∫≠p vƒÉn b·∫£n c·∫ßn m√£ h√≥a ho·∫∑c gi·∫£i m√£..."></textarea>

    <label for="a">Kh√≥a a (nguy√™n t·ªë c√πng 26):</label>
    <input type="number" id="a" min="1" max="25" value="5">

    <label for="b">Kh√≥a b (0‚Äì25):</label>
    <input type="number" id="b" min="0" max="25" value="8">

    <button onclick="encryptAffine()">M√£ h√≥a</button>
    <button onclick="decryptAffine()">Gi·∫£i m√£</button>

    <h3>K·∫øt qu·∫£:</h3>
    <textarea id="outputText" rows="4" readonly></textarea>

    <script>
        function mod26(n) {
            return ((n % 26) + 26) % 26;
        }

        function modInverse(a) {
            for (let i = 1; i < 26; i++) {
                if ((a * i) % 26 === 1) return i;
            }
            return -1;
        }

        function affine(text, a, b, decrypt = false) {
            let result = '';
            const a_inv = modInverse(a);
            if (decrypt && a_inv === -1) return "Kh√¥ng th·ªÉ gi·∫£i m√£: a kh√¥ng c√≥ ngh·ªãch ƒë·∫£o modulo 26.";

            for (let char of text) {
                if (/[A-Za-z]/.test(char)) {
                    const base = char === char.toUpperCase() ? 'A'.charCodeAt(0) : 'a'.charCodeAt(0);
                    const x = char.charCodeAt(0) - base;
                    const y = decrypt
                        ? mod26(a_inv * (x - b))
                        : mod26(a * x + b);
                    result += String.fromCharCode(y + base);
                } else {
                    result += char;
                }
            }
            return result;
        }

        function encryptAffine() {
            const text = document.getElementById("inputText").value;
            const a = parseInt(document.getElementById("a").value);
            const b = parseInt(document.getElementById("b").value);
            document.getElementById("outputText").value = affine(text, a, b, false);
        }

        function decryptAffine() {
            const text = document.getElementById("inputText").value;
            const a = parseInt(document.getElementById("a").value);
            const b = parseInt(document.getElementById("b").value);
            document.getElementById("outputText").value = affine(text, a, b, true);
        }
    </script>
</body>
</html>