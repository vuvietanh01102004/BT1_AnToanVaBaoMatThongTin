<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>M√£ h√≥a Ho√°n v·ªã</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f9ff;
      max-width: 600px;
      margin: auto;
      padding: 40px;
    }
    input, textarea, button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      font-size: 16px;
    }
    button {
      background-color: #0077cc;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #005fa3;
    }
  </style>
</head>
<body>
  <h2>üîê M√£ h√≥a Ho√°n v·ªã (Transposition Cipher)</h2>

  <label for="inputText">VƒÉn b·∫£n:</label>
  <textarea id="inputText" rows="4" placeholder="Nh·∫≠p vƒÉn b·∫£n c·∫ßn m√£ h√≥a ho·∫∑c gi·∫£i m√£...">THAINGUYENDEP</textarea>

  <label for="keyInput">Kh√≥a ho√°n v·ªã (v√≠ d·ª•: 2 4 1 3):</label>
  <input type="text" id="keyInput" value="2 4 1 3">

  <button onclick="encrypt()">M√£ h√≥a</button>
  <button onclick="decrypt()">Gi·∫£i m√£</button>

  <h3>K·∫øt qu·∫£:</h3>
  <textarea id="outputText" rows="4" readonly></textarea>

  <script>
    function parseKey(keyStr) {
      return keyStr.trim().split(/\s+/).map(Number);
    }

    function encrypt() {
      const text = document.getElementById("inputText").value;
      const key = parseKey(document.getElementById("keyInput").value);
      const cols = key.length;
      const rows = Math.ceil(text.length / cols);
      const matrix = Array.from({ length: rows }, () => Array(cols).fill('X'));

      let idx = 0;
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          if (idx < text.length) {
            matrix[r][c] = text[idx++];
          }
        }
      }

      let result = '';
      for (let k = 0; k < key.length; k++) {
        const col = key[k] - 1;
        for (let r = 0; r < rows; r++) {
          result += matrix[r][col];
        }
      }

      document.getElementById("outputText").value = result;
    }

    function decrypt() {
      const cipher = document.getElementById("inputText").value;
      const key = parseKey(document.getElementById("keyInput").value);
      const cols = key.length;
      const rows = Math.ceil(cipher.length / cols);
      const matrix = Array.from({ length: rows }, () => Array(cols).fill(''));

      let idx = 0;
      for (let k = 0; k < key.length; k++) {
        const col = key[k] - 1;
        for (let r = 0; r < rows; r++) {
          if (idx < cipher.length) {
            matrix[r][col] = cipher[idx++];
          }
        }
      }

      let result = '';
      for (let r = 0; r < rows; r++) {
        for (let c = 0; c < cols; c++) {
          result += matrix[r][c];
        }
      }

      result = result.replace(/X+$/, '');
      document.getElementById("outputText").value = result;
    }
  </script>
</body>
</html>